# 練習 タスク管理アプリ

- アプリ名(ディレクトリ名)は rails_task です。
- モデル名は task です。
- scaffoldで作成して下さい。
- 日本語化(画面のラベルを日本語に変更)します。

<br>

![task.gif](images/task.gif)

<br>

## データベース定義

カラム名とデータ型は以下の通りです。

| カラム名|データ型| 
|:-----------|:------------|
| タスク名: name       |       string |
| カテゴリ: category     |      string |   
| 期限: due_date       |        date |    
| メモ: memo         |          text |      

## アプリ作成前の準備

アプリごとにgemのバージョンが異なる場合が多いですが、アプリごとにDocker環境を作ることで個別に管理できます。  

1. VSCode(Visual Studio Code)を起動します。  ([アプリの起動方法](/00_env/01_mac/01_mac/02.md)を参照)
2. `command` を押しながら `o` を押すとファイルを選択する画面が出ます 。
3. `camp` > `03_server_side` > `rails` ディレクトリを選んで `新規フォルダ`をクリックします。
4. `rails_task` ディレクトリを作成し `開く` をクリックします。
5. `camp/docker_file`の中身(`docker` `docker-compose.yml`)を`rails_task`ディレクトリ内にコピーします。（下記のコマンドでもOKです）

<br>

ディレクトリ構造

```diff
  rails_task
+   ├ docker
+   │   ├ app
+   │   │   ├ Dockerfile
+   │   │   └ Gemfile
+   │   └ db
+   │       ├ Dockerfile
+   │       └ my.cnf
+   └ docker-compose.yml
```

docker-compose.ymlを修正します。

appコンテナー内に作成するディレクトリをアプリ名にする為、以下の部分を修正します。

```diff
  version: "3.7"
  services:
    app:
      # ビルドの設定
      build:
        # Dockerfileの場所を指定
        context: docker/app/
        # build時に使用する環境変数を指定
        args:
-         WORK_DIR: ${APP_ROOT}
+         WORK_DIR: /rails_task
      # マウントするディレクトリを指定
      volumes:
        # <host-path>:<docker-path>:<option>
-       - .:${APP_ROOT}:cached
+       - .:/rails_task:cached
        # <volumes>:<docker-path>
        - bundle:/usr/local/bundle
      # appコンテナとmacのport番号3000番を接続
      ports:
        - 3000:3000
      # tty(標準入出力)を使う
      tty: true
      # 連携するコンテナを指定(これでappを起動する前にdbを起動する)
      depends_on:
        - db
    db:
      # Dockerfileの相対Path
      build: docker/db/
      # 環境変数としてパスワードを設定
      environment:
        MYSQL_ROOT_PASSWORD: password
      # データの保存場所を設定
      volumes:
        - "mysql-data:/var/lib/mysql"
      ports:
        - 3306:3306
  # データを永続化
  volumes:
    # ボリュームの名前
    bundle:
    mysql-data:
```

Dockerコンテナを起動

```bash
# イメージをbuild
[mac] $ docker-compose build

# コンテナを起動 -dオプションでデタッチ
[mac] $ docker-compose up -d

# appコンテナに接続
[mac] $ docker-compose exec app bash
```

<br>

### Rails new

Rails アプリの作成します。  

```bash
[app] $ rails new .
# Gemfileがすでに存在するため、以下のメッセージが表示されるので、「y」を押した後にenterを押します。
       exist
      create  README.md
      create  Rakefile
      create  .ruby-version
      create  config.ru
      create  .gitignore
    conflict  Gemfile
Overwrite /rails_task/Gemfile? (enter "h" for help) [Ynaqdh]
```

<br>

以降の作業は、各自考えながら進めて下さい。


<br>
<br>
<br>


### hint

| カラム名|データ型| 
|:-----------|:------------|
| タスク名(task_name)|string |
| カテゴリ(category) |string |   
| 期限 (due_date)| date or datetime |    
| 備考 (note)|text |
